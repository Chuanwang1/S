# STM32智能语音分类垃圾桶

## 项目简介

本项目是一个基于STM32微控制器的智能语音分类垃圾桶系统，能够通过语音识别技术自动分类垃圾并控制相应的垃圾桶盖子开启。系统集成了多种传感器和执行器，实现了垃圾自动分类、容量检测、状态显示等功能。

## 主要功能

### 1. 垃圾容量检测
- 使用红外传感器检测垃圾桶是否已满
- 当垃圾桶装满时，系统会通过串口输出提示信息

### 2. 语音识别垃圾种类
- 通过语音识别模块识别垃圾类型
- 支持4种垃圾类型识别：
  - 可回收垃圾
  - 厨余垃圾
  - 有害垃圾
  - 其他垃圾

### 3. 语音播报功能
- 系统能够语音播报识别到的垃圾种类

### 4. OLED显示功能
- 显示4个垃圾桶的投递次数
- 显示垃圾桶是否已满状态

### 5. 精准控制垃圾桶盖子
- 识别垃圾成功后精准打开或关闭对应垃圾桶盖子
- 使用舵机控制垃圾桶盖子的开关

### 6. 智能照明系统
- 实现白天关灯、黑夜开灯的自动照明功能

### 7. 云平台连接
- 通过WiFi模块连接云平台
- 云平台可查看垃圾桶是否已满

### 8. 手动控制功能
- 提供物理按键，可手动打开垃圾桶

## 硬件组成

### 主控芯片
- STM32F103系列微控制器

### 传感器模块
- 红外传感器（4个）：用于检测垃圾桶是否已满
- 语音识别模块：用于识别垃圾种类

### 执行器
- 舵机（4个）：用于控制垃圾桶盖子的开关
- LED灯：用于照明系统

### 显示模块
- OLED显示屏：用于显示垃圾桶状态和投递次数

### 通信模块
- WiFi模块：用于连接云平台
- 串口通信：用于与语音识别模块和WiFi模块通信

### 按键
- 物理按键（4个）：用于手动控制垃圾桶

## 软件架构

### 主要文件结构
```
├── CORE/              # 核心文件
├── HARDWARE/          # 硬件驱动
│   ├── ADC/           # ADC驱动
│   ├── DS18B20/       # 温度传感器驱动
│   ├── GPIO/          # GPIO驱动
│   ├── KEY/           # 按键驱动
│   ├── MOTOR_DUOJI/   # 舵机驱动
│   └── OLED/          # OLED显示驱动
├── STM32F10x_FWLib/   # STM32固件库
├── SYSTEM/            # 系统文件
│   ├── delay/         # 延时函数
│   ├── sys/           # 系统配置
│   └── usart/         # 串口驱动
└── USER/              # 用户代码
    └── main.c         # 主程序
```

### 主要功能模块

#### 1. 主程序 (main.c)
- 系统初始化
- 主循环处理：按键检测、语音监控、垃圾桶管理

#### 2. 舵机控制 (motor_duoji.c)
- 初始化PWM信号控制舵机
- 控制4个垃圾桶盖子的开关

#### 3. OLED显示 (oled.c)
- 初始化OLED显示屏
- 显示垃圾桶状态和投递次数

#### 4. 按键处理 (key.c)
- 检测按键状态
- 处理手动控制指令

#### 5. GPIO控制 (gpio.c)
- 初始化LED和红外传感器
- 控制LED状态
- 读取红外传感器数据

#### 6. 串口通信 (usart.c)
- 初始化串口通信
- 处理语音识别模块和WiFi模块的数据

## 工作原理

### 1. 系统启动
- 系统上电后进行各模块初始化
- OLED显示初始界面，显示4个垃圾桶的名称和状态
- 舵机初始化到关闭位置

### 2. 垃圾分类处理流程
1. 用户说出垃圾类型或按下对应按键
2. 语音识别模块识别垃圾类型并发送指令到STM32
3. STM32根据指令控制对应垃圾桶的舵机开启
4. 延时2秒后自动关闭舵机
5. OLED显示更新投递次数

### 3. 垃圾桶满检测
- 红外传感器持续检测垃圾桶状态
- 当垃圾桶装满时，对应的绿色LED熄灭，红色LED点亮
- 通过串口输出垃圾桶已满信息

### 4. 云平台通信
- WiFi模块定期向云平台发送垃圾桶状态信息
- 云平台可远程监控垃圾桶状态

## 使用说明

### 操作步骤
1. 确保系统电源正常连接
2. 系统启动后等待初始化完成
3. 通过以下方式投递垃圾：
   - 语音控制：说出垃圾类型
   - 手动控制：按下对应按键
4. 观察OLED显示屏确认操作结果

### 按键功能
- 按键1：控制可回收垃圾桶
- 按键2：控制厨余垃圾桶
- 按键3：控制有害垃圾桶
- 按键4：控制其他垃圾桶

## 扩展功能

### 可添加的功能
1. 增加更多垃圾类型识别
2. 添加温度检测功能
3. 增强云平台功能，实现数据分析和统计
4. 添加手机APP远程控制功能
5. 增加垃圾分类错误提醒功能

## 开发环境

### 硬件要求
- STM32开发板（基于STM32F103系列）
- 语音识别模块
- WiFi模块
- OLED显示屏
- 舵机（4个）
- 红外传感器（4个）
- LED灯
- 按键（4个）

### 软件要求
- Keil uVision5 或其他STM32开发环境
- STM32固件库
- 相关驱动程序

## 注意事项

1. 确保电源供电稳定，避免系统异常复位
2. 定期清洁红外传感器，确保检测准确性
3. 避免舵机长时间处于极限位置，以免损坏
4. 注意语音识别模块的环境噪声影响
5. 定期检查WiFi模块连接状态

## 维护与故障排除

### 常见问题及解决方法
1. **垃圾桶盖子无法正常开启**
   - 检查舵机连接是否正常
   - 检查PWM信号是否正常输出
   - 检查电源供电是否充足

2. **语音识别不准确**
   - 检查语音模块连接
   - 确保周围环境噪声较小
   - 更新语音识别模型

3. **OLED显示异常**
   - 检查I2C连接
   - 检查OLED电源供电
   - 重新烧录显示驱动程序

4. **WiFi连接失败**
   - 检查WiFi模块连接
   - 确认网络配置正确
   - 检查天线连接

## 版权声明

本项目仅供学习交流使用，未经授权不得用于商业用途。如需用于商业用途，请联系项目开发者获得授权。
